<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>CHSH'sBlog</title>


    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.teal-pink.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
    <link rel="stylesheet" href="/stylesheets/styles.css">
    <style>
        .recommeng-card > .mdl-card__title {
            color: #fff;
            height: 250px;
            background: url('/images/banner.jpg') center / cover;
        }
        .recommeng-card > .mdl-card__menu {
            color: #fff;
        }
        .demo-card-image.mdl-card {
            width: 300px;
            height: 450px;

        }
        .demo-card-image > .mdl-card__actions {
            height: 52px;
            padding: 16px;
            /*background: rgba(0, 0, 0, 0.2);*/
        }
        .demo-card-image__filename {
            /*color: #fff;*/
            font-size: 14px;
            font-weight: 500;
        }
        .movieContent{
            margin-bottom: 20px;
        }
        a{
            text-decoration: none;
            color: #fff;
        }
        h3{
            line-height: 10px;
        }
        .container{
            padding: 10px;
        }
        .movieImage{
            width: auto;
            height: auto;
            padding: 0;
        }
        #more-fab {
            position: fixed;
            display: block;
            right: 0;
            bottom: 0;
            margin-right: 40px;
            margin-bottom: 40px;
            z-index: 900;
        }
    </style>
</head>

<body class="chsh mdl-color--grey-100 mdl-color-text--grey-700 mdl-base">
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
    <!--导航栏-->
    <header class="mdl-layout__header mdl-layout__header--waterfall mdl-color--primary">
        <!--为了header大一点设置的header-row-->
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">

        </div>
        <div class="mdl-layout mdl-layout__header-row">
            <h3>CHSH的博客</h3>
        </div>
        <div class="mdl-layout--large-screen-only mdl-layout__header-row">
        </div>
        <div class="mdl-layout__tab-bar mdl-js-ripple-effect mdl-color--primary-dark">
            <a href="/" class="mdl-layout__tab">主页</a>
            <a href="/article/articlePage" class="mdl-layout__tab">文章列表</a>
            <a href="/page" class="mdl-layout__tab is-active">推荐</a>
            <a href="/aboutUs" class="mdl-layout__tab">关于我们</a>
            <a href="/article/writeArticle" class="mdl-layout__tab" id="submitArticle">发布文章</a>
        </div>
    </header>
    <main class="mdl-layout__content">
        <!--正文部分-->
        <div class="mdl-grid" id="movie-grid">

        </div>
        <p id="text"> </p>
        <ul class="pagination" id ="jqPaginator">

        </ul>
        <!--页脚部分-->
        <footer class="mdl-mini-footer">
            <div class="mdl-mini-footer__left-section">
                <div class="mdl-logo">CHSH'sBlog</div>
                <ul class="mdl-mini-footer__link-list">
                    <li><a href="www.getmdl.io/">We Use Google Material Degisn Lite</a></li>
                    <li><a href="#">ZUCC-CHSH Group</a></li>
                </ul>
            </div>
        </footer>
    </main>
</div>
<ul class="mdl-menu  mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="more-fab" style="margin-bottom: 10px;">
    <!--<li class="mdl-menu__item">个人信息</li>-->
    <a class="mdl-menu__item" href="/users/loginPage" id="login-item" style="color: black">登录</a>
    <a class="mdl-menu__item" href="/users/logout" id="logout" style="color: black">登出</a>
    <!--<li class="mdl-menu__item" id="ToTop">返回顶部</li>-->
</ul>

<a id="more-fab" class="mdl-button mdl-js-button  mdl-js-ripple-effect mdl-color--accent mdl-color-text--accent-contrast">未登陆</a>
</body>
<script src="/js/jquery-3.3.1.js"></script>
<script type="text/javascript" src="/js/material.js"></script>
<script src="/js/jqPaginator.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        $("#jqPaginator").jqPaginator({
            pageSize:20,
            totalCounts:250,
            visiblePages: 10,
            currentPage: 1,
            first: '<li class="first"><a class="waves-effect waves-teal btn-flat" href="javascript:void(0);">首页</a></li>',
            prev: '<li class="prev"><a class="waves-effect waves-teal btn-flat" href="javascript:void(0);">前一页</a></li>',
            next: '<li class="next"><a class="waves-effect waves-teal btn-flat" href="javascript:void(0);">下一页</a></li>',
            last: '<li class="last"><a class="waves-effect waves-teal btn-flat" href="javascript:void(0);">尾页</a></li>',
            page: '<li class="page"><a class="waves-effect waves-teal btn-flat" href="javascript:void(0);">{{page}}</a></li>',
            onPageChange: function (num, type) {
                $('#text').html('当前第' + num + '页');
                num=16*num-16;

                var url="https://api.douban.com//v2/movie/top250?start="+num+"&count=16";
                $.ajax({
                    url: url,
                    type: 'GET',
                    dataType: 'JSONP',//here
                    success: function (data) {
                        console.log(data);
                        $("#movie-grid").empty();
                        data.subjects.forEach(function (item) {
                            $("#movie-grid").append('<div class="mdl-grid mdl-grid--no-spacing mdl-cell--3-col mdl-cell--2-col-tablet movieContent"><section class="demo-card-image mdl-card mdl-shadow--2dp  mdl-shadow--2dp">'
                                +'<a href="http://127.0.0.1:3000/movieDetail/'+item.id+ '">'+'<img class="mdl-card__title mdl-card--expand movieImage" src='+item.images.small+'>'+'</a>'+
                                    '<div class="mdl-card__actions">'+
                                    '<span class="demo-card-image__filename">'+ item.title+'| 豆瓣评分'+item.rating.average+'</span>'+
                                    ' </div>'+
                                    '</section>'+
                                    '</div>'
                            )
                        })
//        $("#title").val(data.title);
//        $("#author").val(data.author[0]);
//        $("#publisher").val(data.publisher);
//        $("#pages").val(data.pages);
//        $("#binding").val(data.binding);
//        $("#summary").val(data.summary);
//        $("#pubdate").val(data.pubdate);
//        $("#image").attr("src",data.images.medium);
                    }
                });

            }
        });
    })
</script>
<script type="text/javascript" src="/js/jquerysession.js"></script>
<script>
    $(document).ready(function () {
        if($.session.get('user')===undefined||$.session.get('role')==='visitor'){
            $('#submitArticle').remove();
            $("#more-fab").text("未登陆");
        }
        if($.session.get('user')!=undefined){
            $("#more-fab").text('你好 '+$.session.get('user'));
            $("#login-item").remove();
        }
        $("#ToTop").click(function () {
            // $('html, body').animate({scrollTop: 0}, 500);
            scrollTo(0,0)
            // alert("click")
        })
        $("#logout").click(function () {
            $.session.clear();
        })
    })
</script>
</html>